%%Identification
%%The package identifies itself and the LaTeX version needed
\NeedsTeXFormat{LaTeX2e}
\ProvidesPackage{realoracles}[2023/02/05 Representing Real Oracles with colons and such]


%%Requeiried packages and preliminary definitions, needed by the options
%\RequirePackage{mathabx}
\RequirePackage{ulem} %underlining, normalem is to allow for normal bibtex emphasis
\RequirePackage{graphicx} %used for the wall symbol rotation

% the 3 vertical dots come from mathabx. but that clobbered some stuff so this is a way to have that symbol
%https://tex.stackexchange.com/questions/176941/conflict-between-mathabx-and-other-packages
\DeclareFontFamily{U}{mathb}{\hyphenchar\font45}
\DeclareFontShape{U}{mathb}{m}{n}{
      <5> <6> <7> <8> <9> <10> gen * mathb
      <10.95> mathb10 <12> <14.4> <17.28> <20.74> <24.88> mathb12
      }{}
\DeclareSymbolFont{mathb}{U}{mathb}{m}{n}


%https://tex.stackexchange.com/questions/432778/reduce-spacing-around-colons-in-math-mode
%\DeclareMathSymbol{:}{\mathbin}{mathb}{"33}
%\DeclareMathSymbol{\col}{\mathord}{operators}{"3A}  %gives usual colon
%do \mathrel{\col} for more spaced colon. 
%\mathrel{:} if need colon spaced. 
%want small less than for colon replacement


% Modified from https://tex.stackexchange.com/a/125775
\makeatletter
\def\Ddots{\mathinner{\mkern1mu\raise\p@
\vbox{\kern7\p@\hbox{.}}\mkern-3mu
\raise4\p@\hbox{.}\mkern-2.87mu\raise6.8\p@\hbox{.}\mkern1mu}}
\makeatother

%% Should modify this one too to match the -2.87 and 6.8, but need an example. not sure if we use this
\makeatletter
\def\DDdots{\mathinner{\mkern1mu\raise7\p@
\vbox{\kern7\p@\hbox{.}}\mkern-3mu
\raise4\p@\hbox{.}\mkern-3mu\raise\p@\hbox{.}\mkern1mu}}
\makeatother

%https://latex.org/forum/viewtopic.php?t=1892
\makeatletter
\newcommand*\dln{\rotatebox[origin=c]{90}{$\dabar@\dabar@$}}
\makeatother

\makeatletter
\newcommand*\duln{\raise-5\p@\hbox{$\dabar@\dabar@$}\mkern-16mu}
\makeatother


%from mathabx. see mathtest.pdf page 19
\DeclareMathSymbol{:}{\mathbin}{mathb}{"33} %this does triple dot but just need to type : 
\DeclareMathSymbol{\col}{\mathord}{operators}{"3A}  %gives usual colon
%do \mathrel{\col} for more spaced colon. 
%want small less than for colon replacement
\newcommand{\lt}{\mathord{<}}
\newcommand{\lte}{\Ddots}{%\mathord{\leq}}
\newcommand{\gte}{\DDdots}
\newcommand{\base}[1]{\duln #1 }
\newcommand{\wall}[1]{\dln #1}
\newcommand{\lge}{\mathbin{?}}

\newcommand{\closeto}{\mathord{\rightarrow}}

%https://tex.stackexchange.com/questions/32501/how-to-get-a-good-divisible-by-symbol and
%https://tex.stackexchange.com/questions/147355/how-to-type-tensor-multiplication-with-vertical-dots
%to put the variable in between. baselineskip was .65ex and likskiplimit was 0pt. Changed it as some (in an item with some relations) had the x shifted too much. 
\DeclareRobustCommand{\betrel}[2]{ \mathrel{\vbox{\baselineskip.56ex\lineskiplimit1pt\hbox{.}\hbox{\hspace{-#2pt}\vspace{-1pt}\tiny\ensuremath{#1}}\hbox{.}}}
}

%\newcommand{\xrel}{\betrel{x}{0.5}}

%slanted
\DeclareRobustCommand{\betrelte}[2]{ \mathrel{\hspace{2pt}\vbox{\baselineskip.56ex\lineskiplimit1pt\hbox{\hspace{+3pt}.}\hbox{\hspace{-#2pt}\vspace{-1.05pt}\tiny\ensuremath{#1}}\hbox{\hspace{-3pt}.}}}
}

\newcommand\scalemath[2]{\scalebox{#1}{\mbox{\ensuremath{\displaystyle #2}}}}


\newcommand{\xrelte}{\betrelte{x}{0.5}}
\DeclareMathSymbol{\vdddots}{\mathalpha}{mathb}{"33} 
\newcommand{\xrel}[1][x]{\ensuremath{\mathrel{\vdddots\underline{#1}\vdddots}}}
\newcommand{\xnan}[1][x]{%
    \ensuremath{\mathrel{\vdddots\vtop{ \offinterlineskip \ialign{
          ##\cr % template
          \ensuremath{#1}\cr % top line
          \noalign{\vspace{0.25ex}}% space
          \hidewidth.\kern-0.1em.\hidewidth\cr % dots
        } }\vdddots}
}}
\newcommand{\xora}[1][x]{\ensuremath{\mathrel{\vdddots\widehat{#1}\vdddots}}}
\newcommand{\oracle}[2][x]{\ensuremath{R_{#1}(#2)}}


%\newcommand{\xrelold}{\ensuremath{:\underline{x}:}}

%For Katex, the following macros can substitue in for the triple dot and slanted dots: 
%    ":": "\\char\"2AF6",
%   "\\:":"\\char\"003A",
%   "\\gte": "\\char\"0706\\,\\!",
% "\\lte": "\\char\"0707\\!"
% The weird spacing is because without it, strange characters seem to appear